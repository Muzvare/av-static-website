<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>AV EcoSystem Long Live AgileBot</title>

    <!-- Bootstrap Core CSS -->
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="/stylesheets/site.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
    <link href="/images/favicon.ico" rel="icon" type="image/ico" />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-91621093-1', 'auto');
      ga('send', 'pageview');

    </script>
</head>
<body class="x2017 x2017_10 x2017_10_10 x2017_10_10_av-ecosystem-review-long-live-agilebot x2017_10_10_av-ecosystem-review-long-live-agilebot_index">
    <link href="/stylesheets/highlighting.css" rel="stylesheet" />
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="/#page-top"><img width="175" src="/images/av-logo-inverse.png" /></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="/#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#why-us">Why us?</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#case-studies">Case Studies</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#about">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#subscribe">Subscribe</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#contact">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
<section id="blog">
  <div class="container">
    <div class="row">
      <div class="col-lg-2">
      </div>
      <div class="col-lg-8 text-left">
        <h2 class='title'><a href="/2017/10/10/av-ecosystem-review-long-live-agilebot/">AV EcoSystem Long Live AgileBot</a></h2>
        <h5 class='date'>10 Oct 2017</h5>
    <p><img alt="live long and prosper" src="/images/live_long_and_prosper.png" /></p>

<p>The AgileBot rubyification yesterday was not without a slight speed bump yesterday as I had set the <code>LIVE_ENV</code> parameter incorrectly on production and got a 500 error when I tried to start the Martin Fowler scrum.  However we still managed a scrum, although I was slightly more stressed than usual with my internet also dropping in and out, but we had two full scrums yesterday with a new project proposed in each.  It seems like the welcoming language that I added is working backwards through time to revitalize the scrums - let&rsquo;s see how that goes today :-)</p>

<p>Anyhow, as soon as the scrum was over I was able to fix my slip, and the &ldquo;Kent&rdquo; Beck scrum went out just as intended on the correct Slack channels, as did the Autograders client meeting and the SHF project meeting, which automatically pinged the relevant channels, yay!  So now that&rsquo;s working I think I can safely shut down the separate node/hubot AgileBot instances and save us $14 a month in Heroku fees.</p>

<p><img src="https://dl.dropbox.com/s/0f1hjompo116pzr/Screenshot%202017-10-10%2009.53.44.png?dl=1" /></p>

<p>That&rsquo;s a good feeling.  Equivalent (monetarily at least) to signing a new Premium member.   In the process I also saw that Redeemify production is costing us $7 a month.  I turned that off.  Would be great to get more cost savings with the AgileVentures&rsquo; WebSiteOne monolith that&rsquo;s currently costing us just under $90 a month.  $50 is two dynos on the Heroku standard plan:</p>

<p><img src="https://dl.dropbox.com/s/ornq35b2xudjt05/Screenshot%202017-10-10%2009.57.56.png?dl=1" /></p>

<p>I&rsquo;d really like to better understand what&rsquo;s using up all this memory and processing on the main site.  We seem to be over our 1GB memory most of the time.  Michael and I had previously identified a time zone gem as being a bit of a culprit there.  We have a ticket for this - perhaps it should be my focus after the next high level review:</p>

<p><a href="https://github.com/AgileVentures/WebsiteOne/issues/1288">https://github.com/AgileVentures/WebsiteOne/issues/1288</a></p>

<p>According to New Relic the app server time is distributed like so</p>

<p><img src="https://dl.dropbox.com/s/br0mx5p34sxm12j/Screenshot%202017-10-10%2010.02.28.png?dl=0" /></p>

<p>I wonder if that implies that we should be optimising the VisitorsController?  Which also makes me think about creating a middleman site to be a light weight host of the landing page &hellip;</p>

<p>Anyhow, what I really wanted to do this morning was knock off a couple of quick features that &ldquo;should&rdquo; be easy now that we have the agile bot in Ruby.  </p>

<ol>
<li>hyperlink the URLs to videos/hangouts<br></li>
<li>ensure that videos also get shared to project channels<br></li>
<li>remove the dates from the automated pings<br></li>
</ol>

<p>I start with 1) and start by refactoring the message contents in the test to DRY them out:</p>
<pre class="highlight ruby"><code>    <span class="n">let</span><span class="p">(</span><span class="ss">:message</span><span class="p">)</span> <span class="p">{</span> <span class="s1">'MockEvent: mock_url'</span> <span class="p">}</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:here_message</span><span class="p">)</span> <span class="p">{</span> <span class="s2">"@here </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
    <span class="n">let</span><span class="p">(</span><span class="ss">:channel_message</span><span class="p">)</span> <span class="p">{</span> <span class="s2">"@channel </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
</code></pre>
<p>Checked that stayed green, and then did a similar refactoring in the app code itself:</p>
<pre class="highlight ruby"><code>    <span class="n">message</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">hangout</span><span class="p">.</span><span class="nf">title</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">hangout</span><span class="p">.</span><span class="nf">hangout_url</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">here_message</span> <span class="o">=</span> <span class="s2">"@here </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">channel_message</span> <span class="o">=</span> <span class="s2">"@channel </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="s2">"</span>
</code></pre>
<p>and got that green.  So now I could test drive the new hyperlink format like so:</p>
<pre class="highlight ruby"><code><span class="n">let</span><span class="p">(</span><span class="ss">:message</span><span class="p">)</span> <span class="p">{</span> <span class="s1">'&lt;mock_url|MockEvent&gt;'</span> <span class="p">}</span>
</code></pre>
<p>see that fail and then make the change in the app code:</p>
<pre class="highlight ruby"><code><span class="n">message</span> <span class="o">=</span> <span class="s2">"&lt;</span><span class="si">#{</span><span class="n">hangout</span><span class="p">.</span><span class="nf">hangout_url</span><span class="si">}</span><span class="s2">|</span><span class="si">#{</span><span class="n">hangout</span><span class="p">.</span><span class="nf">title</span><span class="si">}</span><span class="s2">&gt;"</span>
</code></pre>
<p>and then see all the tests pass.  Now what I needed to do was see that this had the correct effect in a Slack instance, so I started the rails instance locally, and checked I had the Slack authorization token pointing to the test Slack instance.  Then, once I had properly sourced the bash file and removed the safeties on posting to Slack from local I was able to see we were getting the correct message hyperlinking that I wanted (for so long!):</p>

<p><img src="https://dl.dropbox.com/s/a3k1yxm570u6s63/Screenshot%202017-10-10%2010.29.07.png?dl=0" /></p>

<p>And that was so easy that I was tempted to do the same with the video links, and since I was there I also ensured the videos got shared with project channels &hellip; and I got that in a PR:</p>

<p><img alt="https://github.com/AgileVentures/WebsiteOne/pull/1887" src="https://github.com/AgileVentures/WebsiteOne/pull/1887" /></p>

<p>and there we go.  I still really want to remove the unecessary dates from the slack pings, but hopefully I can do that tomorrow and then still have time to do a high level review with Thursday and Friday.  Then perhaps the performance review next week &hellip;?</p>

<h2>Related Videos</h2>

<ul>
<li><a href="https://youtu.be/6lpTEsVnK5Y">&ldquo;Martin Fowler&rdquo; Scrum</a></li>
<li><a href="https://youtu.be/vHDRXgGsSiM">&ldquo;Kent Beck&rdquo; Scrum</a></li>
</ul>

<p>p.s. I threw in a <a href="https://github.com/AgileVentures/WebsiteOne/issues/1888">refactoring ticket</a> as there&rsquo;s the code could look better, and by the time I got back with my coffee the build passed (thanks cucumber second retry) and I got it merged in to see if we could try it before the next scrum &hellip;</p>

        <h2 class='author'>by Sam Joseph</h2>
      </div>  
      <div class="col-lg-2">
      </div>
    </div>  
  </div>  
</section>  
<footer>
    <div class="container">
        <section id="contact">
        <div class="row">
            <div class="col-md-4">
                <h3>AgileVentures</h3>
                <p class="blurb text-muted">Our purpose is to develop better more affordable software solutions to enable non-profits to be more effective and more efficient. We also host a <a href="http://www.agileventures.org">learning community</a> around <a href="https://www.edx.org/xseries/agile-development-using-ruby-rails">free online courses</a> that enable developers to improve their team and software skills, and then to apply them on socially useful projects for non-profits. We are a Charitable Incorporated Organisation (CIO) in the UK. Ref #1170963</p>
            </div>
            <div class="col-md-4">
                <h3>What we do</h3>
                <div class="list">
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Websites</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Apps</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Process Automation</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Software Projects</span></i>
                </div>
                <h4>More on our <a href="/blog">Blog</a></h4>
            </div>
            <div class="col-md-4">
                <h3>Contact Us</h3>
                <div class="contact-list">
                  <!-- <i class="fa fa-envelope fa-lg fa-text fa-fw"><span class='font-override'>&nbsp;&nbsp;</i> -->
                  <i class="fa fa-lg fa-text"><a class='mail' href='mailto:nonprofits@agileventures.org'>nonprofits@<wbr>agileventures.org</a></span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>AgileVentures</span></i>
                  <!-- <i class="fa fa-map-marker fa-lg fa-text fa-fw"></i> -->
                  <i class="fa fa-lg fa-text"><span class='font-override'>The Lodge</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>64 Pinner Road</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>Harrow, HA1 4HZ</span></i>
                </div>
            </div>
        </div>
        </section>
        <div class="row">
            <div class="col-md-4">
                <ul class="list-inline quicklinks">
                    <li><a href="/privacy">Privacy Policy</a>
                    </li>
                    <li><a href="/terms">Terms of Use</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <span class="copyright">Copyright &copy; AgileVentures 2017</span>
            </div>
            <div class="col-md-4">
                <ul class="list-inline social-buttons">
                    <li><a href="https://twitter.com/AgileVentures"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li><a href="https://www.facebook.com/agileventures"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/agileventures"><i class="fa fa-linkedin"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    </section>
</footer>


</body>
</html>
