<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Doing the Right Thing</title>

    <!-- Bootstrap Core CSS -->
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="/stylesheets/site.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
    <link href="/images/favicon.ico" rel="icon" type="image/ico" />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-91621093-1', 'auto');
      ga('send', 'pageview');

    </script>
</head>
<body class="x2017 x2017_02 x2017_02_06 x2017_02_06_doing-the-right-thing x2017_02_06_doing-the-right-thing_index">
    <link href="/stylesheets/highlighting.css" rel="stylesheet" />
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="/#page-top"><img width="175" src="/images/av-logo-inverse.png" /></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="/#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#why-us">Why us?</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#case-studies">Case Studies</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#about">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#subscribe">Subscribe</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#contact">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
<section id="blog">
  <div class="container">
    <div class="row">
      <div class="col-lg-2">
      </div>
      <div class="col-lg-8 text-left">
        <h2 class='title'><a href="/2017/02/06/doing-the-right-thing/">Doing the Right Thing</a></h2>
        <h5 class='date'> 6 Feb 2017</h5>
    <p>Over Thursday and Friday I pushed out what I&rsquo;m calling an &ldquo;escalating call to action&rdquo; on the main AgileVentures site.  The idea had come up in a discussion with Michael in a scrum earlier in the week in which we&rsquo;d been talking about what to display when the user was already logged in, because our initial stab at a call to action &ldquo;Sign up now to start coding&rdquo; was being shown to all users, independent of their logged in status:</p>

<p><img alt="&quot;Sign up now to start coding&quot; banner button" src="https://www.dropbox.com/s/yx69fbv0axhe7kc/Screenshot%202017-02-06%2009.37.58.png?dl=1" /></p>

<p>The impetus to create/add this single &ldquo;call to action&rdquo; had come from a marketing meeting at the beginning of the week where we were looking at the sign up stats, and thinking in terms of funnels through the site.  Of course like all things there were many connections.  Ashley had talked a few months back about the site not really directing folks to take a particular action.  I&rsquo;ve been agitating to think about things in terms of the lean startup funnel:</p>

<p><img alt="lean startup funnel" src="https://leansteps.files.wordpress.com/2012/10/funnel.png" /></p>

<p>It seemed to follow naturally that we might make the call to action vary according to the status of who was on the site, like so:</p>

<ul>
<li>Guest User &ndash;&gt; &ldquo;Sign Up now to start coding!&rdquo;</li>
<li>Logged in User &ndash;&gt; &ldquo;Upgrade to Premium for more support&rdquo;</li>
<li>Premium User &ndash;&gt;  &ldquo;Upgrade to Premium Mob for group sessions with a Mentor&rdquo;</li>
</ul>

<p>On Thursday evening I spiked the view like so:</p>
<pre class="highlight erb"><code><span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">current_user</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">current_user</span><span class="p">.</span><span class="nf">membership_type</span> <span class="o">==</span> <span class="s1">'Basic'</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%</span> <span class="n">path</span> <span class="o">=</span> <span class="n">new_subscription_path</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%</span> <span class="n">message</span> <span class="o">=</span> <span class="s1">'Upgrade to Premium for additional support'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">elsif</span> <span class="n">current_user</span><span class="p">.</span><span class="nf">membership_type</span> <span class="o">==</span> <span class="s1">'Premium'</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%</span> <span class="n">path</span> <span class="o">=</span> <span class="n">new_subscription_path</span><span class="p">(</span><span class="ss">plan: </span><span class="s1">'premiummob'</span><span class="p">)</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%</span> <span class="n">message</span> <span class="o">=</span> <span class="s1">'Upgrade to Premium Mob for group sessions with a Mentor'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">else</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="n">path</span> <span class="o">=</span> <span class="n">new_user_registration_path</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="n">message</span> <span class="o">=</span> <span class="s1">'Sign up now to start coding!'</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>

<span class="cp">&lt;%</span> <span class="k">if</span> <span class="n">path</span> <span class="o">&amp;&amp;</span> <span class="n">message</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">&lt;%=</span> <span class="n">path</span> <span class="cp">%&gt;</span><span class="s">"</span> <span class="na">class=</span><span class="s">"btn btn-primary btn-block call-to-action "</span> <span class="na">style=</span><span class="s">"margin: auto; margin-bottom: 10px;"</span><span class="nt">&gt;&lt;span&gt;</span><span class="cp">&lt;%=</span> <span class="n">message</span> <span class="cp">%&gt;</span><span class="nt">&lt;/span&gt;&lt;/a&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</code></pre>
<p>Now this is nasty logic in the view, but it was also an experiment.  I wanted to focus on the business logic in one place, not on the process of pulling that business logic into a model or service.  If I had a secure income it might be another story, but I got something basic working.  Then I wrapped it in tests, breaking it as I went along:</p>
<pre class="highlight gherkin"><code><span class="nt">@vcr</span>
<span class="kd">Feature</span><span class="p">:</span> Escalating Call to Action
  As a site admin
  So that we can move towards sustainability
  I would like users to see an escalating call to action depending on their subscription

  <span class="kn">Background</span><span class="p">:</span>
    <span class="nf">Given</span> the following plans exist
      <span class="p">|</span> <span class="nv">name</span>        <span class="p">|</span> <span class="nv">id</span>         <span class="p">|</span> <span class="nv">amount</span> <span class="p">|</span> <span class="nv">free_trial_length_days</span> <span class="p">|</span>
      <span class="p">|</span> <span class="n">Premium</span>     <span class="p">|</span> <span class="n">premium</span>    <span class="p">|</span> <span class="n">1000</span>   <span class="p">|</span> <span class="n">7</span>                      <span class="p">|</span>
      <span class="p">|</span> <span class="n">Premium</span> <span class="n">Mob</span> <span class="p">|</span> <span class="n">premiummob</span> <span class="p">|</span> <span class="n">2500</span>   <span class="p">|</span> <span class="n">0</span>                      <span class="p">|</span>

  <span class="kn">Scenario</span><span class="p">:</span> Guest user sees call to action which links to sign up page
    <span class="nf">Given</span> I am on the <span class="s">"home"</span> page
    <span class="nf">When</span> I click <span class="s">"Sign up now to start coding!"</span>
    <span class="nf">Then</span> I should be on the <span class="s">"sign up"</span> page

  <span class="kn">Scenario</span><span class="p">:</span> Logged in user sees call to action which links to premium subscription page
    <span class="nf">Given</span> I am logged in
    <span class="nf">And</span> I am on the <span class="s">"home"</span> page
    <span class="nf">When</span> I click <span class="s">"Upgrade to Premium for additional support"</span>
    <span class="nf">Then</span> I should be on the <span class="s">"premium sign up"</span> page

  <span class="nt">@stripe_javascript</span> <span class="nt">@javascript</span>
  <span class="kn">Scenario</span><span class="p">:</span> Premium user sees call to action which links to premium mob subscription page
    <span class="nf">Given</span> I am logged in as a premium user with name <span class="s">"John"</span>, email <span class="s">"john@gmail.com"</span>, with password <span class="s">"12345678"</span>
    <span class="nf">When</span> I click <span class="s">"Upgrade to Premium Mob for group sessions with a Mentor"</span>
    <span class="nf">Then</span> I should be on the <span class="s">"premium mob sign up"</span> page
</code></pre>
<p>Ironically the tests took twice as long to write as the code, mainly due to a Capybara issue with the step that checks that we&rsquo;ve arrived on the correct page, which had to be evolved from this:</p>
<pre class="highlight ruby"><code><span class="no">Then</span> <span class="sr">/^I should be on the "([^"]*)" page$/</span> <span class="k">do</span> <span class="o">|</span><span class="n">page</span><span class="o">|</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">current_path</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="n">path_to</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<p>to</p>
<pre class="highlight ruby"><code><span class="no">Then</span> <span class="sr">/^I should be on the "([^"]*)" page$/</span> <span class="k">do</span> <span class="o">|</span><span class="n">page</span><span class="o">|</span>
  <span class="n">expect</span><span class="p">(</span><span class="n">current_fullpath</span><span class="p">).</span><span class="nf">to</span> <span class="n">eq</span> <span class="n">path_to</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">current_fullpath</span>
  <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">current_url</span><span class="p">).</span><span class="nf">request_uri</span>
<span class="k">end</span>
</code></pre>
<p>after consulting various StackOverflow posts on the subject.  The issue here was that in the (older?) version of Capybara that we are using, the current_path returns the path without the URL params e.g. <code>plan=premiummob</code>, which we need, due to the current design of the subscription controller.  Of course even just writing this down I come back to thoughts from a couple of months back about refactoring the URLs to nest so we could have <code>/plan/premiummob/subscriptions/new</code>.  Gosh, there&rsquo;s just endless extra refactoring we could be doing before being able to conduct experiments on the business logic itself :-)</p>

<p>So, anyway, that was all working and I pushed it out in the background of Friday, and as far as I can tell it&rsquo;s been running over the weekend.  I was in perhaps a hasty rush to put this up.  A last gasp of me being focused on promoting the Premium plans.  There&rsquo;s been no sudden flurry of Premium or Premium Mob sign ups over the weekend :-) It seems like the increase in basic signups is holding steady in a way I wouldn&rsquo;t expect unless the MOOC was active, although that might just be my imagination.  In the same deploy I got the adwords Premium plan conversion live, so if anyone else does convert we can in principle track where they are coming from, but it follows that we should really get the basic sign up AdWord conversion tracking up, and get better stats on the influx of new users, if we&rsquo;re interested in working out how much impact these site changes and AdWord campaigns are really having.</p>

<p>Then again my latest resurgence of Buddhist/Mindful thought is suggesting that strenuous effort in any direction is likely to be counter-productive.  That&rsquo;s supposed to be particularly true for enlightenment.  I love Steve Hagen&rsquo;s metaphor of an archery target.  With enlightenment apparently the closer you get to the center, the further away you actually are.  Somehow you are closest to dead center when you are totally on the periphery.  A pattern I do perceive is how my streneous attempts to resist things will bring them on more strongly or my attempt to grasp them will push them further from me.  It sort of feels like I am caught in a very strange counter-intuitive mental puzzle.</p>

<p>Desperately struggling to try and increase the number of Premium members in AgileVentures may actually make it harder to achieve that end goal.  I think it&rsquo;s time to be a lot more relaxed about all this.  I don&rsquo;t think that hurrying is going to get me anywhere pleasant.  It&rsquo;s probably just going to make the current moment hurried and unpleasant.  Everything just is.</p>

<p>Related Videos:</p>

<ul>
<li><a href="https://www.youtube.com/watch?v=Gacp_DDpO5M">&ldquo;Martin Fowler&rdquo; scrum</a></li>
<li><a href="https://www.youtube.com/watch?v=hzaQlua3_5s">&ldquo;Kent Beck&rdquo; scrum</a></li>
<li><a href="https://www.youtube.com/watch?v=si2W8keQG4o">&ldquo;Bob Martin&rdquo; scrum</a></li>
</ul>

        <h2 class='author'>by Sam Joseph</h2>
      </div>  
      <div class="col-lg-2">
      </div>
    </div>  
  </div>  
</section>  
<footer>
    <div class="container">
        <section id="contact">
        <div class="row">
            <div class="col-md-4">
                <h3>AgileVentures</h3>
                <p class="blurb text-muted">Our purpose is to develop better more affordable software solutions to enable non-profits to be more effective and more efficient. We also host a <a href="http://www.agileventures.org">learning community</a> around <a href="https://www.edx.org/xseries/agile-development-using-ruby-rails">free online courses</a> that enable developers to improve their team and software skills, and then to apply them on socially useful projects for non-profits. We are a Charitable Incorporated Organisation (CIO) in the UK. Ref #1170963</p>
            </div>
            <div class="col-md-4">
                <h3>What we do</h3>
                <div class="list">
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Websites</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Apps</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Process Automation</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Software Projects</span></i>
                </div>
                <h4>More on our <a href="/blog">Blog</a></h4>
            </div>
            <div class="col-md-4">
                <h3>Contact Us</h3>
                <div class="contact-list">
                  <!-- <i class="fa fa-envelope fa-lg fa-text fa-fw"><span class='font-override'>&nbsp;&nbsp;</i> -->
                  <i class="fa fa-lg fa-text"><a class='mail' href='mailto:nonprofits@agileventures.org'>nonprofits@<wbr>agileventures.org</a></span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>AgileVentures</span></i>
                  <!-- <i class="fa fa-map-marker fa-lg fa-text fa-fw"></i> -->
                  <i class="fa fa-lg fa-text"><span class='font-override'>The Lodge</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>64 Pinner Road</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>Harrow, HA1 4HZ</span></i>
                </div>
            </div>
        </div>
        </section>
        <div class="row">
            <div class="col-md-4">
                <ul class="list-inline quicklinks">
                    <li><a href="/privacy">Privacy Policy</a>
                    </li>
                    <li><a href="/terms">Terms of Use</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <span class="copyright">Copyright &copy; AgileVentures 2017</span>
            </div>
            <div class="col-md-4">
                <ul class="list-inline social-buttons">
                    <li><a href="https://twitter.com/AgileVentures"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li><a href="https://www.facebook.com/agileventures"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/agileventures"><i class="fa fa-linkedin"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    </section>
</footer>


</body>
</html>
