<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Second Interview</title>

    <!-- Bootstrap Core CSS -->
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="/stylesheets/site.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
    <link href="/images/favicon.ico" rel="icon" type="image/ico" />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-91621093-1', 'auto');
      ga('send', 'pageview');

    </script>
</head>
<body class="x2017 x2017_02 x2017_02_22 x2017_02_22_second-interview x2017_02_22_second-interview_index">
    <link href="/stylesheets/highlighting.css" rel="stylesheet" />
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="/#page-top"><img width="175" src="/images/av-logo-inverse.png" /></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="/#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#why-us">Why us?</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#case-studies">Case Studies</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#about">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#subscribe">Subscribe</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#contact">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
<section id="blog">
  <div class="container">
    <div class="row">
      <div class="col-lg-2">
      </div>
      <div class="col-lg-8 text-left">
        <h2 class='title'><a href="/2017/02/22/second-interview/">Second Interview</a></h2>
        <h5 class='date'>22 Feb 2017</h5>
    <p>So yesterday I found myself in a second interview for a &ldquo;Ruby developer&rdquo; job at the UK MOOC provider, FutureLearn.  I&rsquo;ve been applying for jobs here and there over the last six months as it&rsquo;s nice to keep one&rsquo;s options open.  Having surrendered to the idea that AgileVentures won&rsquo;t provide a sustainable income for me anytime soon, it was nice to get a first interview (over Skype) at FutureLearn and then a tech test, and then a second interview.  I was looking forward to the afternoon which was going to be broken up into a discussion of my tech test, a pair programming session and a meeting with some client and frontend specialists.</p>

<p>The tech test was on writing a game of TicTacToe, which I think I&rsquo;ve blogged about before, and I used an outside-in approach as I&rsquo;d done with the VendingMachine tech test example at Makers Academy.  This approach had not produced code that I was wonderfully proud of, but I was pleased with parts of my hand rolled acceptance tests, and how one could generate new ones from written descriptions of game play that matched the user experience.  I felt I&rsquo;d done a reasonable job of method naming, and had started on refactoring out some different classes.  Late on Friday evening during my week off I&rsquo;d done another version of TicTacToe starting from inside-out, and on the train on the way into the meeting I pushed that a little further, as I was thinking I was starting to more clearly grasp how these two different approaches intermixed.</p>

<p>In my second version I&rsquo;d driven from unit-tests focused on domain entities such as board, cell and player.  I was at the point of starting to have these entities communicate with each other to play a turn of TicTacToe, or at least update the board representation to reflect a players move.  In the first session with the various methods of the different objects at the forefront of my mind I had written the following: </p>
<pre class="highlight ruby"><code><span class="n">move</span> <span class="o">=</span> <span class="n">player</span><span class="p">.</span><span class="nf">choose_move</span><span class="p">(</span><span class="no">TicTacToe</span><span class="p">.</span><span class="nf">valid_moves</span><span class="p">(</span><span class="n">board</span><span class="p">))</span> 
<span class="n">board</span><span class="p">.</span><span class="nf">contents_of</span><span class="p">(</span><span class="n">move</span><span class="p">).</span><span class="nf">hold</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="nf">symbol</span><span class="p">)</span>
</code></pre>
<p>dropping that into the README in the first instance, as a rough sketch of how the domain entities might communicate.  I read that back to myself on the train and felt like I wanted to move the <code>valid_moves</code> check into the player object, giving me:</p>
<pre class="highlight ruby"><code><span class="n">move</span> <span class="o">=</span> <span class="n">player</span><span class="p">.</span><span class="nf">choose_move</span><span class="p">(</span><span class="n">board</span><span class="p">)</span> 
<span class="n">board</span><span class="p">.</span><span class="nf">contents_of</span><span class="p">(</span><span class="n">move</span><span class="p">).</span><span class="nf">hold</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="nf">symbol</span><span class="p">)</span>
</code></pre>
<p>My reasoning being that a player entity might well want to be able to review the state of the rest of the board, rather than just the valid moves, before choosing what to do next.  I got the player spec set up to handle that, and after a couple of rounds of changes, and with a dash of dependency injection I had the player spec like so:</p>
<pre class="highlight ruby"><code><span class="n">describe</span> <span class="no">Player</span> <span class="k">do</span>

  <span class="n">subject</span><span class="p">(</span><span class="ss">:player</span><span class="p">)</span> <span class="p">{</span> <span class="n">described_class</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">rules_klass</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:board</span><span class="p">)</span> <span class="p">{</span> <span class="n">double</span> <span class="ss">:board</span><span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:rules_klass</span><span class="p">)</span> <span class="p">{</span> <span class="n">double</span> <span class="ss">:rules_klass</span><span class="p">}</span>

  <span class="n">it</span> <span class="s1">'can choose a move'</span> <span class="k">do</span>
    <span class="n">allow</span><span class="p">(</span><span class="n">rules_klass</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:valid_moves</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="n">board</span><span class="p">).</span><span class="nf">and_return</span><span class="p">(</span><span class="ss">:A1</span><span class="p">)</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="nf">choose_move</span><span class="p">(</span><span class="n">board</span><span class="p">)).</span><span class="nf">to</span> <span class="n">eq</span> <span class="ss">:A1</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>
<p>and the player thus:</p>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Player</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">rules_klass</span> <span class="o">=</span> <span class="no">TicTacToe</span><span class="p">)</span>
    <span class="vi">@rules_klass</span> <span class="o">=</span> <span class="n">rules_klass</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">choose_move</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="no">Array</span><span class="p">(</span><span class="n">rules_klass</span><span class="p">.</span><span class="nf">valid_moves</span><span class="p">(</span><span class="n">board</span><span class="p">)).</span><span class="nf">sample</span>
  <span class="k">end</span>

  <span class="kp">private</span> 

  <span class="kp">attr_reader</span> <span class="ss">:rules_klass</span>
<span class="k">end</span>
</code></pre>
<p>before I moved on to being able to update the board.  Now the <code>board.contents_of(move).hold(player.symbol)</code> line reflected the properties of the board and cell objects that I had created before.  What would the context be for such a statement?  I created a game class that would have a <code>handle_move(player)</code> method that would house this code.  The spec ended up looking like this:</p>
<pre class="highlight ruby"><code><span class="n">describe</span> <span class="no">Game</span> <span class="k">do</span>

  <span class="n">subject</span><span class="p">(</span><span class="ss">:game</span><span class="p">)</span> <span class="p">{</span> <span class="n">described_class</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">board_klass</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:board_klass</span><span class="p">)</span> <span class="p">{</span><span class="n">double</span><span class="p">(</span><span class="ss">:board_klass</span><span class="p">)}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:player</span><span class="p">)</span> <span class="p">{</span> <span class="n">double</span><span class="p">(</span><span class="ss">:player</span><span class="p">,</span> <span class="ss">symbol: </span><span class="s1">'X'</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:board</span><span class="p">)</span> <span class="p">{</span> <span class="n">double</span><span class="p">(</span><span class="ss">:board</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:cell</span><span class="p">)</span> <span class="p">{</span> <span class="n">double</span><span class="p">(</span><span class="ss">:cell</span><span class="p">)</span> <span class="p">}</span>

  <span class="n">it</span> <span class="s1">'handles player moves by updating board with player move'</span> <span class="k">do</span>
    <span class="n">allow</span><span class="p">(</span><span class="n">board_klass</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:new</span><span class="p">).</span><span class="nf">and_return</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">allow</span><span class="p">(</span><span class="n">player</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:choose_move</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="n">board</span><span class="p">).</span><span class="nf">and_return</span> <span class="ss">:A1</span>
    <span class="n">expect</span><span class="p">(</span><span class="n">board</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:contents_of</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="ss">:A1</span><span class="p">).</span><span class="nf">and_return</span> <span class="n">cell</span>
    <span class="n">allow</span><span class="p">(</span><span class="n">cell</span><span class="p">).</span><span class="nf">to</span> <span class="n">receive</span><span class="p">(</span><span class="ss">:hold</span><span class="p">).</span><span class="nf">with</span><span class="p">(</span><span class="s1">'X'</span><span class="p">)</span>
    <span class="n">game</span><span class="p">.</span><span class="nf">handle_move</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
  <span class="k">end</span>

<span class="k">end</span>
</code></pre>
<p>I think what I was seeing here was a mock train wreck that reflected a possible Demeter violation in the way I had initially written the code.  I had all the tests passing with the Game class set up like this:</p>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Game</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">board_klass</span> <span class="o">=</span> <span class="no">Board</span><span class="p">)</span>
    <span class="vi">@board</span> <span class="o">=</span> <span class="n">board_klass</span><span class="p">.</span><span class="nf">new</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">handle_move</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
    <span class="n">move</span> <span class="o">=</span> <span class="n">player</span><span class="p">.</span><span class="nf">choose_move</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
    <span class="n">board</span><span class="p">.</span><span class="nf">contents_of</span><span class="p">(</span><span class="n">move</span><span class="p">).</span><span class="nf">hold</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="nf">symbol</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="kp">attr_reader</span> <span class="ss">:board</span>
<span class="k">end</span>
</code></pre>
<p>The train journey ended before I could get any further, but I sensed that the way the test was pointing me would look something like this:</p>
<pre class="highlight ruby"><code><span class="n">board</span><span class="p">.</span><span class="nf">register</span><span class="p">(</span><span class="n">move</span><span class="p">,</span> <span class="ss">by: </span><span class="n">player</span><span class="p">)</span>
</code></pre>
<p>Not sure about that <code>by:</code> key - just trying to make things as close to an English sentence as possible, which is always a little tricky when a method takes more than one argument.  What I thought the convolution in the test was telling me was that game knew a little too much (a Demeter violation) about the relations that board had with the Cell class.  Changing the code to this last example would mean that the Game class didn&rsquo;t need to have any knowledge of the Cell class, and so testing it would be much simpler, and my domain entities would be more loosely coupled.  I think this is the point that&rsquo;s made in the book &ldquo;Test Driving Object Oriented Design&rdquo;, and it strikes me that this is one of the potential benefits of unit tests, which is to help one evolve one&rsquo;s domain entities into a more loosely coupled configuration.</p>

<p>Ironically this didn&rsquo;t really come up in the discussion of the tech test at FutureLearn, although we did talk a lot about how most folks attempted the TicTacToe test by creating a series of small classes (as I had done in this second attempt) and I quoted Sandi Metz&rsquo;s 100 line class limit and noted on the dangers of refactoring before one is clear what the next round of changes are likely to be. That latter being my justification for refactoring out a board class, but not yet a player class, in my initial outside-in approach.</p>

<p>It strikes me that being sufficiently familiar with RSpec to be able to mock effectively and to be aware how the presence of excessive mocking (or mocking things you don&rsquo;t own) is quite a tall order for the beginning programmer.  Furthermore, this benefit is lost, to a degree, when working in a framework like Rails, where the system architecture is laid out for you.  Immediately after the tech test discussion, I was pairing with a different FutureLearn person on adding a feature to a slimmed down version of their site.  We used an interesting style of &lsquo;Given/When/Then&rsquo; within an RSpec/Capybara feature test and then dropped to controller and model specs to get the job done.  It was a smooth pairing experience, switching driver/navigator roles when we got the error message to change significantly.  It just underlined how different it is working with Rails as opposed to Plain Old Ruby Objects (PORO).</p>

<p>I could go on about the final section of the day, but with code snippets this blog has already gotten quite lengthy, but suffice to say that I was impressed with FutureLearn&rsquo;s interview process and the effort to which they were going to have the interview be a reflection of what it was like to work in their team. </p>

        <h2 class='author'>by Sam Joseph</h2>
      </div>  
      <div class="col-lg-2">
      </div>
    </div>  
  </div>  
</section>  
<footer>
    <div class="container">
        <section id="contact">
        <div class="row">
            <div class="col-md-4">
                <h3>AgileVentures</h3>
                <p class="blurb text-muted">Our purpose is to develop better more affordable software solutions to enable non-profits to be more effective and more efficient. We also host a <a href="http://www.agileventures.org">learning community</a> around <a href="https://www.edx.org/xseries/agile-development-using-ruby-rails">free online courses</a> that enable developers to improve their team and software skills, and then to apply them on socially useful projects for non-profits. We are a Charitable Incorporated Organisation (CIO) in the UK. Ref #1170963</p>
            </div>
            <div class="col-md-4">
                <h3>What we do</h3>
                <div class="list">
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Websites</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Apps</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Process Automation</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Software Projects</span></i>
                </div>
                <h4>More on our <a href="/blog">Blog</a></h4>
            </div>
            <div class="col-md-4">
                <h3>Contact Us</h3>
                <div class="contact-list">
                  <!-- <i class="fa fa-envelope fa-lg fa-text fa-fw"><span class='font-override'>&nbsp;&nbsp;</i> -->
                  <i class="fa fa-lg fa-text"><a class='mail' href='mailto:nonprofits@agileventures.org'>nonprofits@<wbr>agileventures.org</a></span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>AgileVentures</span></i>
                  <!-- <i class="fa fa-map-marker fa-lg fa-text fa-fw"></i> -->
                  <i class="fa fa-lg fa-text"><span class='font-override'>The Lodge</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>64 Pinner Road</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>Harrow, HA1 4HZ</span></i>
                </div>
            </div>
        </div>
        </section>
        <div class="row">
            <div class="col-md-4">
                <ul class="list-inline quicklinks">
                    <li><a href="/privacy">Privacy Policy</a>
                    </li>
                    <li><a href="/terms">Terms of Use</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <span class="copyright">Copyright &copy; AgileVentures 2017</span>
            </div>
            <div class="col-md-4">
                <ul class="list-inline social-buttons">
                    <li><a href="https://twitter.com/AgileVentures"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li><a href="https://www.facebook.com/agileventures"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/agileventures"><i class="fa fa-linkedin"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    </section>
</footer>


</body>
</html>
