<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>AV Website Review Part 5</title>

    <!-- Bootstrap Core CSS -->
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="/stylesheets/site.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
    <link href="/images/favicon.ico" rel="icon" type="image/ico" />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-91621093-1', 'auto');
      ga('send', 'pageview');

    </script>
</head>
<body class="x2017 x2017_07 x2017_07_11 x2017_07_11_av-website-review-part-five x2017_07_11_av-website-review-part-five_index">
    <link href="/stylesheets/highlighting.css" rel="stylesheet" />
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="/#page-top"><img width="175" src="/images/av-logo-inverse.png" /></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="/#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#why-us">Why us?</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#case-studies">Case Studies</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#about">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#subscribe">Subscribe</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#contact">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
<section id="blog">
  <div class="container">
    <div class="row">
      <div class="col-lg-2">
      </div>
      <div class="col-lg-8 text-left">
        <h2 class='title'><a href="/2017/07/11/av-website-review-part-five/">AV Website Review Part 5</a></h2>
        <h5 class='date'>11 Jul 2017</h5>
    <p>So what I really meant to do yesterday was to look at the flows going through various pages in the site via Google Analytics.  Here&rsquo;s a view that compares June with May this year:</p>

<p><img alt="behaviour flow around sign up page, may vs jun" src="https://dl.dropbox.com/s/hf47so53v8lnhyw/Screenshot%202017-07-11%2009.23.15.png?dl=1" /></p>

<p>It&rsquo;s perhaps even more revealing to compare June this year with June last year:</p>

<p><img alt="behaviour flow around sign up page, jun 16 vs jun 17" src="https://dl.dropbox.com/s/j1yzvlujhm0qttm/Screenshot%202017-07-11%2009.27.31.png?dl=1" /></p>

<p>What we can see clearly here is the big increase from those viewing &rsquo;/code&rsquo; and &rsquo;/learn&rsquo; (I shortened those and added sign up call to actions at the end of them recently) and the massive increase in those going to &rsquo;/getting-started&rsquo; (a few months back we adjusted it so that you go to &ldquo;getting started&rdquo; after signing in).</p>

<p>Of the 1200 people landing on the sign_up page in June, we had 380 just stop there and go no further.  I&rsquo;m wondering if that figure could be improved by the deployment of a privacy policy and re-enabling email signups?  </p>

<p>What&rsquo;s perhaps more concerning is the 299 drop offs out of the 793 sessions on the &lsquo;getting started&rsquo; page.  Of course maybe the reality is that we can&rsquo;t change either of these drop off rates significantly.   I&rsquo;ve just experiemented with changes to the &#39;getting started&rsquo; page and so it seems sensible to leave that for a while.  Although maybe we should be A/B testing rather than comparing longitudinally?  Anyhow, I&rsquo;ve got the privacy statement all linked up into the sign up page:</p>

<p><img alt="sign up page with privacy link" src="https://dl.dropbox.com/s/ggj4vgtqytlm5jp/Screenshot%202017-07-11%2009.34.22.png?dl=1" /></p>

<p>Overall I think the page looks pretty good.  We previously fixed up the icons and made both signup methods work, so the only garish thing remaining is this email signup disabled.  I found there&rsquo;s a <a href="https://github.com/plataformatec/devise/wiki/How-To:-Use-Recaptcha-with-Devise">plugin for devise to add Google&rsquo;s re-captcha</a>.  Working through it I got stuck with the configuration, but fixed it and put in a PR to the repo with the fix:</p>

<p>https://github.com/ambethia/recaptcha/pull/231</p>

<p>and so was rewarded with seeing the following in my local spike:</p>

<p><img alt="first pass at adding recaptcha" src="https://dl.dropbox.com/s/fxj5vfx9wzj5sb3/Screenshot%202017-07-11%2009.54.23.png?dl=1" /></p>

<p>but while I could click on the I&rsquo;m not a robot, I got &ldquo;verification failed&rdquo; after signup:</p>

<p><img alt="verification failed" src="https://dl.dropbox.com/s/bieuh1rayk3l9i7/Screenshot%202017-07-11%2009.55.37.png?dl=1" /></p>

<p>All the log was telling me was: </p>
<pre class="highlight plaintext"><code>Filter chain halted as :check_captcha rendered or redirected
</code></pre>
<p>I added byebug to the check_captcha method I&rsquo;d added to the registrations controller:</p>
<pre class="highlight ruby"><code>  <span class="n">prepend_before_action</span> <span class="ss">:check_captcha</span><span class="p">,</span> <span class="ss">only: </span><span class="p">[</span><span class="ss">:create</span><span class="p">]</span> 

  <span class="k">def</span> <span class="nf">create</span>
    <span class="k">super</span>
    <span class="k">unless</span> <span class="vi">@user</span><span class="p">.</span><span class="nf">new_record?</span>
      <span class="n">session</span><span class="p">[</span><span class="ss">:omniauth</span><span class="p">]</span> <span class="o">=</span> <span class="kp">nil</span>
      <span class="n">flash</span><span class="p">[</span><span class="ss">:user_signup</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Signed up successfully.'</span>
      <span class="no">Mailer</span><span class="p">.</span><span class="nf">send_welcome_message</span><span class="p">(</span><span class="vi">@user</span><span class="p">).</span><span class="nf">deliver_now</span> <span class="k">if</span> <span class="no">Features</span><span class="p">.</span><span class="nf">enabled?</span><span class="p">(</span><span class="ss">:welcome_email</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>


  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">check_captcha</span>
    <span class="n">byebug</span>
    <span class="k">unless</span> <span class="n">verify_recaptcha</span>
      <span class="nb">self</span><span class="p">.</span><span class="nf">resource</span> <span class="o">=</span> <span class="n">resource_class</span><span class="p">.</span><span class="nf">new</span> <span class="n">sign_up_params</span>
      <span class="n">resource</span><span class="p">.</span><span class="nf">validate</span> <span class="c1"># Look for any other validation errors besides Recaptcha</span>
      <span class="n">respond_with_navigational</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">:new</span> <span class="p">}</span>
    <span class="k">end</span>
  <span class="k">end</span>
</code></pre>
<p>Stepping through the code there made it look like the verification was failing - nothing else wrong.  The <code>verify_recaptcha</code> method was returning false &hellip; Not sure what&rsquo;s going wrong there and I have the sinking feeling that adding the captcha, as I have, may screw up the other signup methods.  We&rsquo;ll see.  First I just need proof positive that we can get it to work at all &hellip; It may be that I just can&rsquo;t run it locally like this - I added the <code>localhost</code> domain to the domains associated with keys to run locally, but maybe there&rsquo;s more needed to run locally.  I can see that there&rsquo;s a domain name verification setting in the reCaptcha settings:</p>

<p><img alt="recaptcha settings" src="https://www.dropbox.com/s/53j9mi92omzrls9/Screenshot%202017-07-11%2010.04.42.png?dl=1" /></p>

<p>I&rsquo;m just trying a restart &hellip; and another step through &hellip; which seemed to work without any changes.  Hmm, maybe the restart did it &hellip; I also played with the layout to make it all look a little better:</p>

<p><img alt="new layout" src="https://www.dropbox.com/s/la5kden3qy8zsb1/Screenshot%202017-07-11%2010.12.41.png?dl=1" /></p>

<p>which I assume didn&rsquo;t actually change things.  Test again without the byebug &hellip; and that works, although I note I get two &ldquo;signed up successfully messages&rdquo; - tried to screen shot, but they fade out a little fast; would like to fix that.  Also I get nicely redirected to the &ldquo;Getting Started&rdquo; page.  Okay, well that&rsquo;s the spike - sure it breaks lots of things, but might as well push that up as a spike PR to see how it all runs on CI.  Guess we&rsquo;ll need sandboxing &hellip;?  Look at that tomorrow.</p>

        <h2 class='author'>by Sam Joseph</h2>
      </div>  
      <div class="col-lg-2">
      </div>
    </div>  
  </div>  
</section>  
<footer>
    <div class="container">
        <section id="contact">
        <div class="row">
            <div class="col-md-4">
                <h3>AgileVentures</h3>
                <p class="blurb text-muted">Our purpose is to develop better more affordable software solutions to enable non-profits to be more effective and more efficient. We also host a <a href="http://www.agileventures.org">learning community</a> around <a href="https://www.edx.org/xseries/agile-development-using-ruby-rails">free online courses</a> that enable developers to improve their team and software skills, and then to apply them on socially useful projects for non-profits. We are a Charitable Incorporated Organisation (CIO) in the UK. Ref #1170963</p>
            </div>
            <div class="col-md-4">
                <h3>What we do</h3>
                <div class="list">
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Websites</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Apps</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Process Automation</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Software Projects</span></i>
                </div>
                <h4>More on our <a href="/blog">Blog</a></h4>
            </div>
            <div class="col-md-4">
                <h3>Contact Us</h3>
                <div class="contact-list">
                  <!-- <i class="fa fa-envelope fa-lg fa-text fa-fw"><span class='font-override'>&nbsp;&nbsp;</i> -->
                  <i class="fa fa-lg fa-text"><a class='mail' href='mailto:nonprofits@agileventures.org'>nonprofits@<wbr>agileventures.org</a></span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>AgileVentures</span></i>
                  <!-- <i class="fa fa-map-marker fa-lg fa-text fa-fw"></i> -->
                  <i class="fa fa-lg fa-text"><span class='font-override'>The Lodge</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>64 Pinner Road</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>Harrow, HA1 4HZ</span></i>
                </div>
            </div>
        </div>
        </section>
        <div class="row">
            <div class="col-md-4">
                <ul class="list-inline quicklinks">
                    <li><a href="/privacy">Privacy Policy</a>
                    </li>
                    <li><a href="/terms">Terms of Use</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <span class="copyright">Copyright &copy; AgileVentures 2017</span>
            </div>
            <div class="col-md-4">
                <ul class="list-inline social-buttons">
                    <li><a href="https://twitter.com/AgileVentures"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li><a href="https://www.facebook.com/agileventures"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/agileventures"><i class="fa fa-linkedin"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    </section>
</footer>


</body>
</html>
