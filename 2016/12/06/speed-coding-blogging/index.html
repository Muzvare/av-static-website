<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Speed Coding and Blogging</title>

    <!-- Bootstrap Core CSS -->
    <link href="/stylesheets/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link href="/stylesheets/site.css" rel="stylesheet" />
    <script src="/javascripts/all.js"></script>
    <link href="/images/favicon.ico" rel="icon" type="image/ico" />

</head>
<body class="x2016 x2016_12 x2016_12_06 x2016_12_06_speed-coding-blogging x2016_12_06_speed-coding-blogging_index">
    <link href="/stylesheets/highlighting.css" rel="stylesheet" />
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand page-scroll" href="/#page-top"><img width="175" src="/images/av-logo-inverse.png" /></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="/#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#services">Why us?</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#portfolio">Case Studies</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#about">About</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#subscribe">Subscribe</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="/#contact">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
<section id="blog">
  <div class="container">
    <div class="row">
      <div class="col-lg-2">
      </div>
      <div class="col-lg-8 text-left">
        <h2 class='title'><a href="/2016/12/06/speed-coding-blogging/">Speed Coding and Blogging</a></h2>
        <h5 class='date'> 6 Dec 2016</h5>
    <p>Monday was the usual fight against torpor, but did get an hour&rsquo;s pairing in with Michael on WSO where Michael drove a finish to putting the Paypal payment button on the same page as the Stripe credit card payment.  Before he started on that I got him to pull out the refactoring of the ChargesController to SubscriptionController into a separate pull request.  In the background I had half an eye on the builds of that which were failing due to some regressions on changes to cucumber steps.  We pared down the feature for putting the Paypal element front and center to:</p>
<pre class="highlight gherkin"><code><span class="nt">@stripe_javascript</span> <span class="nt">@javascript</span>
<span class="kd">Feature</span><span class="p">:</span> Subscribe Self to Premium
  As a developer
  So that I can get recurring professsional development support and code review
  I would like to take out an AV Premium Subscription

  <span class="kn">Background</span><span class="p">:</span>
    <span class="nf">Given</span> the following plans exist
      <span class="p">|</span> <span class="nv">name</span>        <span class="p">|</span> <span class="nv">id</span>          <span class="p">|</span>
      <span class="p">|</span> <span class="n">Premium</span>     <span class="p">|</span> <span class="n">premium</span>     <span class="p">|</span>

  <span class="kn">Scenario</span><span class="p">:</span> Pay by card
    <span class="nf">Given</span> I visit <span class="s">"subscriptions/new"</span>
    <span class="nf">And</span> I click <span class="s">"Subscribe"</span> within the card_section
    <span class="nf">When</span> I fill in appropriate card details for premium
    <span class="nf">Then</span> I should see <span class="s">"Thanks, you're now an AgileVentures Premium Member!"</span>
    <span class="nf">And</span> the user should receive a <span class="s">"Welcome to AgileVentures Premium"</span> email
    <span class="c"># And my member page should show premium details # TODO IMPORTANT - require login?</span>

  <span class="kn">Scenario</span><span class="p">:</span> Pay by Paypal
    <span class="nf">Given</span> I visit <span class="s">"subscriptions/new"</span>
    <span class="nf">Then</span> I should see a paypal form within the paypal_section
    <span class="c"># And the user should receive a "Welcome to AgileVentures Premium" email</span>
    <span class="c"># And my member page should show premium details # TODO IMPORTANT - will need hookup</span>
</code></pre>
<p>Leaving in a few comments pointing at important future work.  Feel a bit messy about that - would it be better to be pointing to tickets as part of the bigger premium epic there?  Over lunch I left Michael pairing with Matt who&rsquo;d been observing our pairing session.  They were looking at the feature on preventing tweets of dud videos that Sasha had left, and rather than get involved in a complex refactoring I suggested that the way forward was a new branch that wrapped the existing Twitter functionality in acceptance tests.  &ldquo;Characterisation tests&rdquo; of legacy code as Michael reminded us.  We&rsquo;ll see if all this breaking out of smaller PRs bites us with merge conflicts or makes review easier.  Raoul&rsquo;s been really busy recently so we might have to look at our PR review and deploy process to take account.</p>

<p>After lunch I solo&rsquo;d to add a sad path to the refactoring of the Premium branch that we&rsquo;d identified since one missing part of the refactoring wasn&rsquo;t caught by the tests.  I got that green and then started on tweaking the CSS for the Premium payment page now that it included both Paypal and Stripe buttons.  Working with the CSS was frustrating, as our controller specific stylesheets don&rsquo;t load automatically on WSO, and even though I identified the code in the layout that would, turning that on produced <a href="https://github.com/AgileVentures/WebsiteOne/issues/1445">weird breakages throughout the cucumber tests</a>.  There&rsquo;s definitely something a little strange going on with the layout - which I think is also affecting performance on my local machine when running in develop mode.  Could this be affecting performance on the main system?  Perhaps a review of our layouts is in order.</p>

<p>I hacked out a reasonable solution pulling in the controller specific stylesheet directly in the view:</p>
<pre class="highlight html"><code><span class="err">&lt;</span>%= stylesheet_link_tag params[:controller], 'data-turbolinks-track' =&gt; true  %&gt;
</code></pre>
<p>and found that the bootstrap <code>well</code> class produced the sort of effect I wanted:</p>

<p><img alt="payment buttons" src="https://www.dropbox.com/s/eelk7vro2owibuv/Screenshot%202016-12-06%2009.40.56.png?dl=1" /></p>

<p>The missing piece going forward is getting the Paypal payment to hit a webhook and update our WSO backend when payment completes.  From the Paypal documentation this looks not too hard.  It makes me think that there might have been a simpler way to get set up with Stripe buttons.  Do we actually have to hit Stripe&rsquo;s server from our server to sign someone up to a subscription?  Could there be a pure button equivalent?  Although all the docs I&rsquo;m looking at suggest that you still have to explicitly create the customer with a server side call.  Anyhow, further Paypal integration is the priority if we are going to support Paypal based sponsoring of other members.</p>

<p>Tinkering with the CSS all burnt a lot of time and I reflected that I&rsquo;m behind on sending out emails to AV members, pushing older blogs to medium and social media, and there are a lot of Premium pull requests to review, let alone project management for LocalSupport, AsyncVoter and making sure we are delivering to are commitments to Sponsors.  Short of making more time in the day I think I have to limit the time I spend writing the daily blog to a tight 20 minutes.  People keep telling me I&rsquo;m too verbose generally so perhaps that will be an improvement :-)</p>

<h3>Related Videos</h3>

<ul>
<li><a href="https://youtu.be/KqT5XWirMRg">&ldquo;Martin Fowler&rdquo; Scrum</a></li>
<li><a href="https://www.youtube.com/watch?v=y7bHXz0kCQA">Pairing on WSO</a></li>
<li><a href="https://www.youtube.com/watch?v=EOlcarJgn8s">Soloing on WSO</a></li>
<li><a href="https://www.youtube.com/watch?v=RQc_9isrGJY">&ldquo;Kent Beck&rdquo; Scrum</a></li>
</ul>

        <h2 class='author'>by Sam Joseph</h2>
      </div>  
      <div class="col-lg-2">
      </div>
    </div>  
  </div>  
</section>  
<footer>
    <div class="container">
        <section id="contact">
        <div class="row">
            <div class="col-md-4">
                <h3>AgileVentures</h3> 
                <p class="blurb text-muted">Our purpose is to develop better more affordable software solutions to enable non-profits to be more effective and more efficient. We also host a <a href="http://www.agileventures.org">learning community</a> around <a href="https://www.edx.org/xseries/agile-development-using-ruby-rails">free online courses</a> that enable developers to improve their team and software skills, and then to apply them on socially useful projects for non-profits. We are awaiting approval of our application to become a Charitable Incorporated Organisation (CIO) in the UK.</p>
            </div>
            <div class="col-md-4">
                <h3>What we do</h3>
                <div class="list">
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Websites</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Apps</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Process Automation</span></i>
                    <i class="fa fa-check fa-lg fa-text"><span class='font-override'>&nbsp;&nbsp;Software Projects</span></i>
                </div>
                <h4>More on our <a href="/blog">Blog</a></h4>
            </div>
            <div class="col-md-4">
                <h3>Contact Us</h3>
                <div class="contact-list">
                  <!-- <i class="fa fa-envelope fa-lg fa-text fa-fw"><span class='font-override'>&nbsp;&nbsp;</i> -->
                  <i class="fa fa-lg fa-text"><a class='mail' href='mailto:nonprofits@agileventures.org'>nonprofits@<wbr>agileventures.org</a></span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>AgileVentures</span></i>
                  <!-- <i class="fa fa-map-marker fa-lg fa-text fa-fw"></i> -->
                  <i class="fa fa-lg fa-text"><span class='font-override'>The Lodge</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>64 Pinner Road</span></i>
                  <i class="fa fa-lg fa-text"><span class='font-override'>Harrow, HA1 4HZ</span></i>
                </div>
            </div>
        </div>
        </section>
        <div class="row">
            <div class="col-md-4">
                <ul class="list-inline quicklinks">
                    <li><a href="/privacy">Privacy Policy</a>
                    </li>
                    <li><a href="/terms">Terms of Use</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <span class="copyright">Copyright &copy; AgileVentures 2016</span>
            </div>
            <div class="col-md-4">
                <ul class="list-inline social-buttons">
                    <li><a href="https://twitter.com/AgileVentures"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li><a href="https://www.facebook.com/agileventures"><i class="fa fa-facebook"></i></a>
                    </li>
                    <li><a href="https://www.linkedin.com/company/agileventures"><i class="fa fa-linkedin"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    </section>
</footer>

</body>
</html>
