<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Blog Name</title>
  <subtitle>Blog subtitle</subtitle>
  <id>http://blog.url.com/</id>
  <link href="http://blog.url.com/"/>
  <link href="http://blog.url.com/feed.xml" rel="self"/>
  <updated>2017-07-04T01:00:00+01:00</updated>
  <author>
    <name>Blog Author</name>
  </author>
  <entry>
    <title>All Good Things ...</title>
    <link rel="alternate" href="http://blog.url.com/2017/07/04/all-good-things/"/>
    <id>http://blog.url.com/2017/07/04/all-good-things/</id>
    <published>2017-07-04T01:00:00+01:00</published>
    <updated>2017-07-10T21:54:43+01:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;img alt="good things" src="/images/good_things.jpg" /&gt;&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ve been daily blogging for a year now.  Working day blogs that is.  I haven&amp;rsquo;t been blogging on weekends, or national holidays, or during my vacations.  I&amp;rsquo;ve been pretty consistent.  I think there&amp;rsquo;s been a couple of days where work was super busy due to the tail end of a design sprint or something, but I&amp;rsquo;ve managed to retro-actively blog and keep it one per work day.  I started blogging in June last year doing a blog on a different platform each day of the week, but fairly soon I fell into a pattern of blogging to our AgileVentures middleman site, and then re-releasing to Medium after I&amp;rsquo;d got a little distance from the blog itself.&lt;/p&gt;

&lt;p&gt;What was the purpose of this blog frenzy?  My memory is that it was about trying to communicate more effectively.  I often end up assuming that people understand my thoughts and intentions and it turns out that actually they don&amp;rsquo;t.  Of course why would they?  There are few telepaths around.  I&amp;rsquo;m also a bit of a gabbler and my sense is that it&amp;rsquo;s not super easy to understand what I&amp;rsquo;m trying to communicate.  So blogging, get all the thoughts down in text, provide them in an accessible form for everyone to read, and maybe reduce my need to gabble on and on about things.  Win win, no?  There&amp;rsquo;s also the motivation that blogging at the start of each day is a kind of &amp;ldquo;morning pages&amp;rdquo; activity such as writers use to start off their days and clear their heads.  I don&amp;rsquo;t think writers usually publish their morning brain dump, but I have certainly found the process of starting each day with writing out my thoughts to be reassuring and relaxing.  &lt;/p&gt;

&lt;p&gt;Earlier in the year when I was doing a lot more coding, the blogs tended to be all about the previous day&amp;rsquo;s coding.  As AgileVentures became an official charity and my admin load increased, they have tended to be about prioritization.  Starting the day with a blog is certainly less stressful than starting the day with a review of email and Slack conversations, which will generally lead to many adds to my ever-increasing todo list.  Has the time been well spent?  I&amp;rsquo;m not sure.  I&amp;rsquo;ve had positive reactions to some blogs, but my sense is that the blogs are too long, too stream-of-consciousness, too un-focused to gain much traction.  I think I may have even alienated some with my uncensored and unedited thought processes.&lt;/p&gt;

&lt;p&gt;Ever since I was 17 I&amp;rsquo;ve never really had trouble just generating text, and from even earlier I was always a talker.  It&amp;rsquo;s like my internal thought wheel is hooked up directly to my mouth, and at will I can hook it up to a pen or a keyboard and just dump my thoughts straight out, for better or for worse.  So I rarely have writer&amp;rsquo;s block, but it leaves me with a different problem.  How to edit the thicket of thoughts and ideas, so as to more effectively communicate them?&lt;/p&gt;

&lt;p&gt;Getting to the end of a year of blogging prompts thoughts of changing things going forward.  There&amp;rsquo;ve been times in the past when rising early I&amp;rsquo;ve done 3 hours of programming before breakfast.  After recent design sprints I think about doing coding sprints, or other activities that fill the week in different ways.  Should it be one blog a week with the blog being edited and revised each day, so that a single polished blog can be released on Friday?  I guess it all depends on what one wants to achieve, and hasn&amp;rsquo;t the Buddhist in me been trying to follow a path of consecrated action, where one is totally unattached to the outcomes of activities?&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;d have loved my blogs to have provoked more positive responses of &amp;ldquo;yes, let&amp;rsquo;s build a solution to that together &amp;hellip;&amp;rdquo;, although there has been some of that.  What I really would like is for AgileVentures to be a healthy thriving community providing great learning experiences for many, while also helping charitable causes around the world.  The process of reflection over the last year does make me think that we&amp;rsquo;re far too text heavy in many, many parts of our interface with the world.  One of the most attractive ideas for me going forward is that I&amp;rsquo;d spend my blogging time each day focused on a part of the main AgileVentures site, converting it from text heavy to text light and adding images.  I have a hunch that, by doing this in strategic places throughout the site, we could improve the sign up rates, the number of members joining projects and the numbers signing up for Premium subscriptions, the source of our financial sustainability.&lt;/p&gt;

&lt;p&gt;That said, I have a feeling I won&amp;rsquo;t be able to shake the blogging habit.  The process has become too solidly part of my daily routine.  The thing that actually gets me started and ready to work in the mornings.  So, anyhow, starting tomorrow, blogs that focus on parts of the main AgileVentures site.  I&amp;rsquo;m going to work through it one day at a time.&lt;/p&gt;

&lt;p&gt;p.s. this blog released early for inclusion in our July newsletter, earlier blogs are all in draft form in GitHub and will be on this site soon&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Azure MediaWiki Stack Part 5</title>
    <link rel="alternate" href="http://blog.url.com/2017/05/25/azure-mediawiki-stack-part5/"/>
    <id>http://blog.url.com/2017/05/25/azure-mediawiki-stack-part5/</id>
    <published>2017-05-25T01:00:00+01:00</published>
    <updated>2017-07-18T22:07:29+01:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;img alt="mediawiki" src="/images/MediaWiki.svg" /&gt;&lt;/p&gt;

&lt;p&gt;So, after feeling lethargic and getting distracted by only a small amount of Slack and Email, it&amp;rsquo;s time to see if I can repeat the trick of getting the MediaWiki VisualEditor to work with https.  Maybe this is all just ridiculous yak-shaving.  I&amp;rsquo;m getting a steady flow of spam on the wiki and I need to try out some solutions without damaging the production server.  I want to try out various things on staging before they are in production.  So yes, coherent argument for getting the staging server setup, but then the newly deployed box is on a slightly different version of MediaWiki and installing the LetsEncrypt SSL all suddenly went more smoothly, so for all my efforts to create a clone of production, will there still be differences creeping in? With technology, trivial differences in versions can lead things to break; however, driving to get that 100% match can also suck up ever increasing amounts of time &amp;hellip;&lt;/p&gt;

&lt;p&gt;Heroku&amp;rsquo;s deploying via git with something like bundler to ensure that we have precisely the same set of libraries really does feel like a beautifully clear approach, and we can get the same from dokku.  I wonder if there&amp;rsquo;s some similar way to deploy MediaWiki that would allow us to version all our configuration.  And how long would it take to find it and set it up? :-)&lt;/p&gt;

&lt;p&gt;Task in hand - let&amp;rsquo;s continue.  Got to log into four ssh terminals for start up &amp;hellip; so I got distracted there (for 15mins?) and I used &lt;code&gt;ssh-copy-id&lt;/code&gt; to set it up so I can log in with my private key rather than having to use the password every time.  That should save some time in the long run.&lt;/p&gt;

&lt;p&gt;What I lack is a good record of exactly what changes I made to the Apache config on the production box, although comparing &lt;code&gt;/opt/bitnami/apache2/conf/httpd.conf&lt;/code&gt;, I don&amp;rsquo;t see any differences.  The version of certbot that I&amp;rsquo;ve used this second time around has put the server certificate and key in &lt;code&gt;/opt/bitnami/apache2/conf&lt;/code&gt;, but the main changes are in &lt;code&gt;/opt/bitnami/apache2/conf/bitnami&lt;/code&gt;, where I did make a copy of the file &lt;code&gt;bitnami.conf&lt;/code&gt;.  The initial change required is to ensure that the site is no longer served over insecure port 80:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;&amp;lt;IfVersion &amp;lt; 2.3 &amp;gt;
  NameVirtualHost *:80 
  NameVirtualHost *:443
&amp;lt;/IfVersion&amp;gt;

&amp;lt;VirtualHost _default_:80&amp;gt;
  DocumentRoot "/opt/bitnami/apache2/htdocs"
  Redirect permanent / https://hlp-wiki-develop.agileventures.org/ # &amp;lt;-- add this
  # ... unchanged
&amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and that whenever anyone tries to access via http over port 80 that they are redirected to the secured https on port 443.  Then restart Apache:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;$ sudo /opt/bitnami/ctlscript.sh restart apache
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and the site can only be accessed over https, but the problem is now that the VisualEditor won&amp;rsquo;t work, or at least it didn&amp;rsquo;t the first time around for me where I seemed to need to set up all sorts of port redirection, but something about this second install means I don&amp;rsquo;t seem to have encountered this issue.  Fascinating.  I don&amp;rsquo;t know if I screwed something up the first time around and made lots more work for myself, OR if the Bitnami stack/certbot I used has been updated.  Definitely there was a bump to the MediaWiki version and I have gone in with a different certbot command.&lt;/p&gt;

&lt;p&gt;So where I&amp;rsquo;m confused now is how good a clone I have of the first box, and the best way to upgrade the first box.  I have another layer of indirection with the first box using the wiki.healthylondon.org domain name, but I don&amp;rsquo;t think that should affect things too seriously &amp;hellip; is it possible that I was completely misdiagnosing the VisualEditor failures?  It&amp;rsquo;s possible, because we had that very tricky bug where only pages with outstanding edits held in the moderation queue were blocking the editor, but I thought that was only on IE.&lt;/p&gt;

&lt;p&gt;I checked the chrome developer tools network panel and all the requests to the VisualEditor are going across https.  I&amp;rsquo;ll check on IE and then I think its time to get down to work.  I want to:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;clone across the data from the production server&lt;/li&gt;
&lt;li&gt;run backups&lt;/li&gt;
&lt;li&gt;experiment with a restore from backup&lt;/li&gt;
&lt;li&gt;experiment with the spam filters suggested by the moderation extension maintainer&lt;/li&gt;
&lt;li&gt;use this as a base to test out other things like defaulting create page to the VisualEditor, etc.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;What I&amp;rsquo;d really like to do is have a mechanism for &amp;ldquo;switching&amp;rdquo; the production server to the newly created box and retiring the old one, so that I can avoid having to upgrade the boxes in place.  It seems like that switching would require DNS changes that take a long time to propagate.  I wonder if Azure has some mechanism for switching between virtual machines &amp;hellip;?  What I&amp;rsquo;d really like is a broader team to do this all with, but that&amp;rsquo;d require another level of funding &amp;hellip;&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Azure MediaWiki Stack Part 4</title>
    <link rel="alternate" href="http://blog.url.com/2017/05/24/azure-mediawiki-stack-part4/"/>
    <id>http://blog.url.com/2017/05/24/azure-mediawiki-stack-part4/</id>
    <published>2017-05-24T01:00:00+01:00</published>
    <updated>2017-07-18T22:11:28+01:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;img alt="mediawiki" src="/images/MediaWiki.svg" /&gt;&lt;/p&gt;

&lt;p&gt;Well I totally failed to get down to my blogging today, checking Slack and Email first.  And blogging this week has become a series on getting the Azure MediaWiki stack up, which arguably should be a single document &amp;hellip; but then lots of people break complex things over multiple blogs.  It will need a lot of polishing back and forth as my stream of consciousness gets in the way of documenting things.  At least yesterday I managed to feel like I was making progress by getting the banner in there so that the cloned site looks like this:&lt;/p&gt;

&lt;p&gt;&lt;img alt="cloned site with banner" src="https://www.dropbox.com/s/cze89vat8f09xs5/Screenshot%202017-05-24%2009.50.00.png?dl=1" /&gt;&lt;/p&gt;

&lt;p&gt;So the remaining hurdle is just setting up SSL, which as I was saying I&amp;rsquo;d partially documented in some comments in a post on the bitnami community:&lt;/p&gt;

&lt;p&gt;https://community.bitnami.com/t/installing-certbot-for-lets-encrypt-ssl-certificate/46431/2&lt;/p&gt;

&lt;p&gt;The original post points us to the bitnami documentation on using LetsEncrypt:&lt;/p&gt;

&lt;p&gt;https://docs.bitnami.com/aws/components/apache/#how-to-install-the-lets-encrypt-client&lt;/p&gt;

&lt;p&gt;Which walks us through installing something called certbot, during which I got/get the following error:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;Failed to find executable apache2ctl in PATH: /opt/bitnami/sqlite/bin:/opt/bitnami/php/bin:/opt/bitnami/mysql/bin:/opt/bitnami/apache2/bin:/opt/bitnami/common/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and it was google searches for that error that lead me to the bitnami community post.  The post suggests the following fix:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;sudo ln -s /opt/bitnami/apache2/bin/apachectl /usr/bin/apache2ctl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and that allowed me to generate a certificate:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;bitnami@bitnami-mediawiki-74f7:/tmp/certbot$ ./certbot-auto certonly --webroot -w /opt/bitnami/apps/mediawiki/htdocs/ -d hlp-wiki-develop.agileventures.org
Requesting root privileges to run certbot...
  /home/bitnami/.local/share/letsencrypt/bin/letsencrypt certonly --webroot -w /opt/bitnami/apps/mediawiki/htdocs/ -d hlp-wiki-develop.agileventures.org
Saving debug log to /var/log/letsencrypt/letsencrypt.log
Enter email address (used for urgent renewal and security notices) (Enter 'c' to
cancel):hlpwikiadmin@agileventures.org

-------------------------------------------------------------------------------
Please read the Terms of Service at
https://letsencrypt.org/documents/LE-SA-v1.1.1-August-1-2016.pdf. You must agree
in order to register with the ACME server at
https://acme-v01.api.letsencrypt.org/directory
-------------------------------------------------------------------------------
(A)gree/(C)ancel: A

-------------------------------------------------------------------------------
Would you be willing to share your email address with the Electronic Frontier
Foundation, a founding partner of the Let's Encrypt project and the non-profit
organization that develops Certbot? We'd like to send you email about EFF and
our work to encrypt the web, protect its users and defend digital rights.
-------------------------------------------------------------------------------
(Y)es/(N)o: Y
Obtaining a new certificate
Performing the following challenges:
http-01 challenge for hlp-wiki-develop.agileventures.org
Using the webroot path /opt/bitnami/apps/mediawiki/htdocs for all unmatched domains.
Waiting for verification...
Cleaning up challenges

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at
   /etc/letsencrypt/live/hlp-wiki-develop.agileventures.org/fullchain.pem.
   Your cert will expire on 2017-08-22. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot-auto
   again. To non-interactively renew *all* of your certificates, run
   "certbot-auto renew"
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.
 - If you like Certbot, please consider supporting our work by:

   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate
   Donating to EFF:                    https://eff.org/donate-le

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which then needs to be installed in the Apache webserver according to the docs, but when I try the next step:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;sudo ln -s /etc/letsencrypt/live/hlp-wiki-develop.agileventures.org/fullchain.pem /opt/bitnami/apache2/conf/server.crt
sudo ln -s /etc/letsencrypt/live/hlp-wiki-develop.agileventures.org/privkey.pem /opt/bitnami/apache2/conf/server.key
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I&amp;rsquo;m told that the files already exist:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;ln: failed to create symbolic link ‘/opt/bitnami/apache2/conf/server.key’: File exists
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and so I start to wonder if I&amp;rsquo;m following different instructions from last time.  I restarted the server&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;sudo /opt/bitnami/ctlscript.sh restart apache
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but the https was not working.  My history from doing this the last time around shows me making various modifications to the Apache config&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;  379  nano httpd.conf 
  380  ls
  381  ls bitnami/
  382  cd ..
  383  ls
  384  sudo mkdir sites-available
  385  ls sites-enabled/
  386  ls -la
  387  chown bitnami sites-available/
  388  sudo chown bitnami sites-available/
  389  sudo chown bitnami sites-enabled
  390  more conf/bitnami/bitnami.conf 
  391  cd conf/bitnami/
  392  pwd
  393  ls
  394  more httpd.conf 
  395  ls
  396  pwd
  397  more bitnami.conf 
  398  more bitnami-apps-prefix.conf
  399  more bitnami-apps-vhosts.conf
  400  ls
  401  more le-redirect-wiki.healthylondon.org.conf
  402  nano le-redirect-wiki.healthylondon.org.conf 
  403  sudo nano le-redirect-wiki.healthylondon.org.conf 
  404  history | grep restart
  405  history | grep apache
  406  sudo /opt/bitnami/ctlscript.sh restart apache
  407  sudo /opt/bitnami/ctlscript.sh restart
  408  sudo nano le-redirect-wiki.healthylondon.org.conf 
  409  sudo /opt/bitnami/ctlscript.sh restart
  410  sudo /opt/bitnami/ctlscript.sh restart apache
  411  sudo nano httpd.conf 
  412  sudo bitnami.conf
  413  sudo nano bitnami.conf 
  414  sudo /opt/bitnami/ctlscript.sh restart apache
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but I can tell I&amp;rsquo;m not getting the full history as I don&amp;rsquo;t see any reference to letsencrypt and I was definitely running the following at some point:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;./letsencrypt-auto --apache --apache-server-root /opt/bitnami/apache2 --apache-challenge-location /opt/bitnami/apache2 --apache-handle-sites FALSE --apache-vhost-root /opt/bitnami/apache2/conf/bitnami -d &amp;lt;domain-name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I had a poke around in the Apache config and saw differences that made me wonder if the new Bitnami stack had changed, or if I had just run a different certbot command this time around.  Https wasn&amp;rsquo;t working, but I saw the cert was from example.com, so I backed up the existing cert and key files and got the link command to work:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;$ sudo mv  /opt/bitnami/apache2/conf/server.crt /opt/bitnami/apache2/conf/server-original.crt
$ sudo mv  /opt/bitnami/apache2/conf/server.key /opt/bitnami/apache2/conf/server-original.key
$ sudo ln -s /etc/letsencrypt/live/hlp-wiki-develop.agileventures.org/fullchain.pem /opt/bitnami/apache2/conf/server.crt
$ sudo ln -s /etc/letsencrypt/live/hlp-wiki-develop.agileventures.org/privkey.pem /opt/bitnami/apache2/conf/server.key
$ sudo /opt/bitnami/ctlscript.sh restart apache
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and then it worked. So either I made it harder than it actually was last time, or something got easier, or I just found a different command that was easier to work with out of the box.  However the trick is now enforcing https and then making sure the VisualEditor can still work over https, but I think that will be for tomorrow&amp;rsquo;s blog i.e. &lt;a href="http://nonprofits.agileventures.org/2017/05/25/azure-mediawiki-stack-part5/"&gt;part 5!&lt;/a&gt; &amp;hellip;&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Azure MediaWiki Stack Part 3</title>
    <link rel="alternate" href="http://blog.url.com/2017/05/23/azure-mediawiki-stack-part3/"/>
    <id>http://blog.url.com/2017/05/23/azure-mediawiki-stack-part3/</id>
    <published>2017-05-23T01:00:00+01:00</published>
    <updated>2017-07-18T22:10:59+01:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;img alt="mediawiki" src="/images/MediaWiki.svg" /&gt;&lt;/p&gt;

&lt;p&gt;Ahhh, so the rebuilding the MediaWiki stack on Azure leaks over three days and I suspect it may be more.  Yesterday I got stuck trying to open a port for the VisualEditor and I suspect there will be other blocks, but that&amp;rsquo;s why I&amp;rsquo;m forcing myself through this to have it all documented so it&amp;rsquo;s not a pain when we are really short on time.  I also got distracted playing with inkscape this morning, but that&amp;rsquo;s another story.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;m not sure that I have time, but I couldn&amp;rsquo;t help checking to see if removing the security rule would prevent the VisualEditor from working, and unless there&amp;rsquo;s some kind of caching going on that I understand, it looks like the security rule really isn&amp;rsquo;t necessary.  I certainly suspected that, since it isn&amp;rsquo;t connected up to anything else in the system.  So in principle I can delete those security rules and that&amp;rsquo;s one less thing to maintain and organise.  Confusing, because we definitely need security rules like that to work with AWS.  Presumably we&amp;rsquo;d need them for some other kinds of configuration on Azure &amp;hellip;&lt;/p&gt;

&lt;p&gt;So the next thing to set up is the SSL, which I remember as somewhat complicated AND there&amp;rsquo;s making sure that the Visual Editor continues to work with the SSL on.  There&amp;rsquo;s also the moderation component, the wikieditor, and the banner.  Also I&amp;rsquo;d like to see if there&amp;rsquo;s some way to run MediaWiki&amp;rsquo;s cucumber tests&lt;/p&gt;

&lt;p&gt;Although I see from the manual that we musn&amp;rsquo;t run the unit tests on a production wiki: https://www.mediawiki.org/wiki/Manual:PHP&lt;em&gt;unit&lt;/em&gt;testing/Running&lt;em&gt;the&lt;/em&gt;unit&lt;em&gt;tests  Perhaps the browser testing is safer: https://www.mediawiki.org/wiki/Browser&lt;/em&gt;testing but it looks like these might also make a mess of a production system.&lt;/p&gt;

&lt;p&gt;Hmm, well maybe I go for the low hanging fruit first.  Let&amp;rsquo;s install the WikiEditor in LocalSettings.php:&lt;/p&gt;
&lt;pre class="highlight php"&gt;&lt;code&gt;## Load WikiEditor

wfLoadExtension('WikiEditor');

# Enables use of WikiEditor by default but still allows users to disable it in preferences
$wgDefaultUserOptions['usebetatoolbar'] = 1;

# Enables link and table wizards by default but still allows users to disable them in preferences
$wgDefaultUserOptions['usebetatoolbar-cgd'] = 1;

# Displays the Preview and Changes tabs
$wgDefaultUserOptions['wikieditor-preview'] = 1;

# Displays the Publish and Cancel buttons on the top right side
$wgDefaultUserOptions['wikieditor-publish'] = 1;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and the Moderation extension:&lt;/p&gt;
&lt;pre class="highlight php"&gt;&lt;code&gt;## Moderation Extension

wfLoadExtension( 'Moderation' );

$wgGroupPermissions['sysop']['moderation'] = true; # Allow sysops to use Special:Moderation
$wgGroupPermissions['sysop']['skip-moderation'] = true; # Allow sysops to skip moderation
$wgGroupPermissions['bot']['skip-moderation'] = true; # Allow bots to skip moderation
$wgGroupPermissions['checkuser']['moderation-checkuser'] = false; # Don't let checkusers see IPs on Special:Moderation

$wgAddGroups['sysop'][] = 'automoderated'; # Allow sysops to assign "automoderated" flag
$wgRemoveGroups['sysop'][] = 'automoderated'; # Allow sysops to remove "automoderated" flag

$wgModerationNotificationEnable = true;
$wgModerationNotificationNewOnly = false;
$wgModerationEmail = $wgEmergencyContact;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which requires the code to be checked out of git into a &lt;code&gt;Moderation&lt;/code&gt; directory in the &lt;code&gt;extensions&lt;/code&gt; folder which also requires installing git:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;$ sudo apt-get install git
$ git clone https://github.com/edwardspec/mediawiki-moderation
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;All the instructions for that are here: https://www.mediawiki.org/wiki/Extension:Moderation#Installation but note that we also need to ensure that the root git directory gets renamed from &lt;code&gt;mediawiki-moderation&lt;/code&gt; to &lt;code&gt;Moderation&lt;/code&gt;.  I can see that&amp;rsquo;s all working as expected on IE11 and also that the maintainer of the Moderation extension has pushed my suggested change to the moderation banner into the master branch of the Moderation GitHub repo.&lt;/p&gt;

&lt;p&gt;There&amp;rsquo;s also the CSS to set up, so that we can have our banner throughtout&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;## Allow Common.css to load on restricted pages 

$wgAllowSiteCSSOnRestrictedPages = true;

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and then drop the following into the Mediawiki:Common.css page:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;/* CSS placed here will be applied to all skins */

#mw-head{
    margin-top:123px;
}
.mw-wiki-logo{
    background-image: none;
}

#hlp-banner {
   /* background:url('https://www.dropbox.com/s/2yokso0fkd3bivt/Screenshot%202017-05-08%2010.40.18.png?dl=1'); */
    width:100%;
    min-height:123px;
}

#block-mhl-hlp-mhl-hlp-logo {
    background: #003992;
}

#block-mhl-hlp-mhl-hlp-logo .content {
    position: relative;
}

#block-mhl-hlp-mhl-hlp-logo .block-inner {
    margin: auto;
    max-width: 1200px;
    text-align: right;
}

#block-mhl-hlp-mhl-hlp-logo .content:before {
    background: url(https://www.healthylondon.org/sites/all/themes/nhslondon/assets/img/hlp-people2.png) left bottom no-repeat;
    background-size: 135px 115px;
    float: left;
}

#block-mhl-hlp-mhl-hlp-logo .content:after {
    background: url(https://www.healthylondon.org/sites/all/themes/nhslondon/assets/img/hlp-people1.png) right bottom no-repeat;
    background-size: 130px 115px;
    float: right;
}

#block-mhl-hlp-mhl-hlp-logo .content:before, #block-mhl-hlp-mhl-hlp-logo .content:after {
    content: '';
    display: inline-block;
    height: 120px;
    margin-top: 5px;
    width: 140px;
}

@media (max-width: 767px) { 
    #block-mhl-hlp-mhl-hlp-logo img {
      width: 220px;
    }
}

@media (max-width: 767px) {
    #block-mhl-hlp-mhl-hlp-logo .content:after, #block-mhl-hlp-mhl-hlp-logo .content:before {
        display: none;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If I recall I made some edits to the Vector template to get the HLP banner in there.  Here&amp;rsquo;s the diff of before and after:&lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt;97,106d96
&amp;lt;       &amp;lt;div id="hlp-banner"&amp;gt;
&amp;lt;                   &amp;lt;div id="block-mhl-hlp-mhl-hlp-logo" class="block block-mhl-hlp"&amp;gt;
&amp;lt;                     &amp;lt;div class="block-inner"&amp;gt;
&amp;lt;                       &amp;lt;div class="content"&amp;gt;
&amp;lt;                         &amp;lt;a href="https://www.healthylondon.org/" class=""&amp;gt;&amp;lt;img typeof="foaf:Image" src="https://www.healthylondon.org/sites/default/files/styles/large/public/healthlondon-logo-ncs1_0.png" alt=""&amp;gt;&amp;lt;/a&amp;gt;
&amp;lt;                       &amp;lt;/div&amp;gt;
&amp;lt;                     &amp;lt;/div&amp;gt;
&amp;lt;                   &amp;lt;/div&amp;gt;
&amp;lt;                 &amp;lt;/div&amp;gt;
&amp;lt;                 &amp;lt;div id="hlp-wrapper"&amp;gt;
248c238
&amp;lt;             &amp;lt;/div&amp;gt;
---
&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which is enough to produce our nice resizable banner.  Okay time to get that SSL in there.  I had thought this was going to be a real pain on Azure, but actually it&amp;rsquo;s all pretty much Apache configuration.  Maybe I get into that tomorrow, as I suspect there will be some sticking points &amp;hellip; I&amp;rsquo;ve posted some notes about how I did it last time:&lt;/p&gt;

&lt;p&gt;https://community.bitnami.com/t/installing-certbot-for-lets-encrypt-ssl-certificate/46431/2&lt;/p&gt;

&lt;p&gt;and I need to follow up with the developer there.  Let&amp;rsquo;s try for that in &lt;a href="http://nonprofits.agileventures.org/2017/05/24/azure-mediawiki-stack-part4/"&gt;part 4&lt;/a&gt; and if I&amp;rsquo;m lucky I&amp;rsquo;ll also get to testing the backup stuff &amp;hellip; and also test importing all the data from the production system into the backup system.&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Azure MediaWiki Stack Part 2</title>
    <link rel="alternate" href="http://blog.url.com/2017/05/22/azure-mediawiki-stack-part2/"/>
    <id>http://blog.url.com/2017/05/22/azure-mediawiki-stack-part2/</id>
    <published>2017-05-22T01:00:00+01:00</published>
    <updated>2017-07-18T22:10:41+01:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;img alt="mediawiki" src="/images/MediaWiki.svg" /&gt;&lt;/p&gt;

&lt;p&gt;I wasn&amp;rsquo;t able to complete a re-run of the NHS HLP MediaWiki installation due partly to getting distracted by other work, but also because the Parsoid service (needed by the VisualEditor) wouldn&amp;rsquo;t install.  I was following the instructions in https://www.mediawiki.org/wiki/Parsoid/Setup but getting &amp;ldquo;E: Unable to locate package parsoid&amp;rdquo;.  I thrashed around, got distracted and then at the end of the day the command just worked.  I had a similar experience with letsencrypt on AsyncVoter, where the letsencrypt server was down, so maybe that was the issue with installing Parsoid, that the wikimedia releases site was down.  Anyway, next step is to configure the Parsoid service, which involved editing &lt;code&gt;/etc/mediawiki/parsoid/config.yaml&lt;/code&gt; and updating the uri, which defaults to &lt;code&gt;http://localhost/w/api.php&lt;/code&gt;.  After various trial and error I&amp;rsquo;d learnt from the previous install that we needed to drop the w, like so:  &lt;/p&gt;
&lt;pre class="highlight plaintext"&gt;&lt;code&gt; # Configure Parsoid to point to your MediaWiki instances.
        mwApis:
        - # This is the only required parameter,
          # the URL of you MediaWiki API endpoint.
          uri: 'http://hlp-wiki-develop.agileventures.org/api.php'
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Noting that we need to use &lt;code&gt;sudo&lt;/code&gt; to make adjustments to this file.  Then we&amp;rsquo;re supposed to adjust settings.js, but I could never find that file and so created it from scratch in the same directory like so:&lt;/p&gt;
&lt;pre class="highlight javascript"&gt;&lt;code&gt;&lt;span class="nx"&gt;parsoidConfig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setMwApi&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="na"&gt;uri&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'http://hlp-wiki-develop.agileventures.org/api.php'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'localhost'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;domain&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'localhost'&lt;/span&gt; &lt;span class="p"&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The instructions make it look like &lt;code&gt;prefix&lt;/code&gt; and &lt;code&gt;domain&lt;/code&gt; need updating, but the above incantation with &amp;lsquo;localhost&amp;rsquo; was the one that worked for me last time around.  Looking at the live system I wonder if the Parsoid service needs to run over the live domain (&amp;#39;wiki.healthylondon.org&amp;rsquo;) or if it could go direct to &lt;code&gt;bitnami-mediawiki-8a65.cloudapp.net&lt;/code&gt;?  Maybe, maybe not, and could other configuration tweaks make the VisualEditor load a bit faster?&lt;/p&gt;

&lt;p&gt;Anyhow, to get the basic VisualEditor up and running we probably need to restart the Parsoid service and add some configuration to the mediawiki instance to know where to talk to the Parsoid service.&lt;/p&gt;
&lt;pre class="highlight shell"&gt;&lt;code&gt;&lt;span class="gp"&gt;$ &lt;/span&gt;sudo service parsoid restart
 &lt;span class="k"&gt;*&lt;/span&gt; Restarting Parsoid HTTP service parsoid
Started Parsoid server on port 8142
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;brings the Parsoid server back up on port 8142, and then the following in LocalSettings.php connects the two up:&lt;/p&gt;
&lt;pre class="highlight php"&gt;&lt;code&gt;## Parsoid Config for Visual Editor

$wgVirtualRestConfig['modules']['parsoid'] = array(
        // URL to the Parsoid instance
        // Use port 8142 if you use the Debian package
        'url' =&amp;gt; 'http://hlp-wiki-develop.agileventures.org:8142',
        // Parsoid "domain", see below (optional)
        'domain' =&amp;gt; 'localhost',
        // Parsoid "prefix", see below (optional)
        'prefix' =&amp;gt; 'localhost'
);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In principle this could all work, but we get errors like this when we try to use the VisualEditor:&lt;/p&gt;

&lt;p&gt;&lt;img alt="could not find server error" src="https://www.dropbox.com/s/xr1198z72jforf0/Screenshot%202017-05-22%2010.21.31.png?dl=1" /&gt;&lt;/p&gt;

&lt;p&gt;And I think the issue here is that the client JavaScript in Mediawiki is trying to contact back to the server on port 8142, which isn&amp;rsquo;t open on the Azure box, so we need to make a change there.  This involves adding a &amp;ldquo;Network Security Group&amp;rdquo;:&lt;/p&gt;

&lt;p&gt;&lt;img alt="adding a &amp;quot;Network Security Group&amp;quot;" src="https://www.dropbox.com/s/w9sb7stbq88wams/Screenshot%202017-05-22%2010.26.37.png?dl=1" /&gt;&lt;/p&gt;

&lt;p&gt;and then an &amp;ldquo;inbound security rule&amp;rdquo;:&lt;/p&gt;

&lt;p&gt;&lt;img alt="an &amp;quot;inbound security rule&amp;quot;" src="https://www.dropbox.com/s/59o0krege5temk9/Screenshot%202017-05-22%2010.28.20.png?dl=1" /&gt;&lt;/p&gt;

&lt;p&gt;but then we still get errors like:&lt;/p&gt;

&lt;p&gt;&lt;img alt="timeout reached" src="https://www.dropbox.com/s/l810011weec2vef/Screenshot%202017-05-22%2010.34.32.png?dl=1" /&gt;&lt;/p&gt;

&lt;p&gt;in which case the Parsoid troubleshooting documentation is useful:&lt;/p&gt;

&lt;p&gt;https://www.mediawiki.org/wiki/Parsoid/Troubleshooting#Configuration&lt;/p&gt;

&lt;p&gt;Although I was stuck here for a while, but I think it comes back to the problem that it doesn&amp;rsquo;t involve adding a security group - at least the way I got it to work last time (which took a while to figure out) was to add an extra endpoint rule to the virtual machine.  Although maybe the security group IS needed.  Blurgh, some experimentation needed here, and this whole process of documenting the setup seems to be taking just as long as figuring out the setup in the first place &amp;hellip;!&lt;/p&gt;

&lt;p&gt;&lt;img alt="adding an endpoint to the virtual machine on Azure" src="https://www.dropbox.com/s/ghzx10bnhbq7nbm/Screenshot%202017-05-22%2011.04.09.png?dl=1" /&gt;&lt;/p&gt;

&lt;p&gt;Ah, so it looks like we need BOTH the endpoint AND the security group; although I&amp;rsquo;m not 100% on that, and I think I&amp;rsquo;m out of time to really determine that &amp;hellip; on to &lt;a href="http://nonprofits.agileventures.org/2017/05/23/azure-mediawiki-stack-part3/"&gt;part 3&lt;/a&gt;&lt;/p&gt;
</content>
  </entry>
  <entry>
    <title>Bayesian Decision Making</title>
    <link rel="alternate" href="http://blog.url.com/2017/05/19/bayesian-decision-making-blog/"/>
    <id>http://blog.url.com/2017/05/19/bayesian-decision-making-blog/</id>
    <published>2017-05-19T01:00:00+01:00</published>
    <updated>2017-07-17T21:25:11+01:00</updated>
    <author>
      <name>Article Author</name>
    </author>
    <content type="html">&lt;p&gt;&lt;img alt="Bayesian" src="/images/bayesian.jpg" /&gt;&lt;/p&gt;

&lt;p&gt;So my blog from yesterday isn&amp;rsquo;t finished.  I got stuck halfway trying to document the mediawiki setup process, and then loads of other things fell on me.  I can feel my decision making process creaking.  I got caught for twenty minutes in Slack and email before starting this blog.  I&amp;rsquo;m reminded of the Bayesian approach to making decisions which seems eminently sensible and is all about working out prior probabilities.  It&amp;rsquo;s been a while and I&amp;rsquo;m sure I&amp;rsquo;m mangling it, and anyway it&amp;rsquo;s impossible to get accurate probabilities, but there&amp;rsquo;s so many things I could work on, and it&amp;rsquo;s so difficult to work out the actual rewards that come from each thing.  I&amp;rsquo;ve got to just start listing them out.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Generate case studies of recent paid NHS and Wikimedia EDU projects (possibly even LocalSupport) &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: 2 hours?&lt;/li&gt;
&lt;li&gt;potential benefit: could help unlock funding from new Myanmar project&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create bid for Capable Communities&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: 1 hour?&lt;/li&gt;
&lt;li&gt;potential benefit: might unlock funding&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Review new first MOOC assignment proposal&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: 1 hour?&lt;/li&gt;
&lt;li&gt;potential benefit: unclear, but MOOC does drive traffic to our site&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Respond to email from &amp;ldquo;Code for Kindness&amp;rdquo;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: 20 minutes&lt;/li&gt;
&lt;li&gt;potential benefit: unclear, but could be good for collaboration&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Respond to email from Safecast&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: 20 minutes&lt;/li&gt;
&lt;li&gt;potential benefit: unclear, but could be good for collaboration&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Attending marketing meeting  &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: ~1hour&lt;/li&gt;
&lt;li&gt;potential benefit: unlocks other folks trying to collaborate on marketing strategy &lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Releasing latest WSO updates&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: ~1hour&lt;/li&gt;
&lt;li&gt;potential benefit: releases changes to flow that might have more people understanding benefits of Premium and then signing up&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Further investigating AsyncVoter routing issues&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: unknown&lt;/li&gt;
&lt;li&gt;potential benefit: clarity about Azure routing, unblocks developers to focus on code&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Sorting LocalSupport repo relations&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: 15 mins&lt;/li&gt;
&lt;li&gt;potential benefit: makes AgileVentures clear owner; and opens route to testing drie deploy&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Completing MediaWiki install and config as clone of HLP wiki&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time to complete: &amp;gt;2 hours?&lt;/li&gt;
&lt;li&gt;potential benefit: gives us a much safer testing area for upgrades and changes&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And there&amp;rsquo;s a slew of other things.  I can&amp;rsquo;t get everything done, and each thing I have mentioned above only includes guesses of the time it takes and what the potential benefits will be.  It wouldn&amp;rsquo;t be such a big deal if I wasn&amp;rsquo;t relying on opening the right doors to bring in enough money to feed my kids.  &lt;/p&gt;

&lt;p&gt;I kicked off the WebSiteOne deployment in the background as that requires a few background steps for CI to run on each of the develop, staging and production instances.  The Bayesian approach calls for prior probabilities to be assessed.  The likelihood that each thing was successful in the past, to help weigh which item to choose &amp;hellip; if I was calm I&amp;rsquo;d go and look up the formula, but I&amp;rsquo;m just too stressed at the moment.  I feel like the critical thing is to get the case-studies of our paid projects written up.  Even if they don&amp;rsquo;t unlock fudning for this Myanmar project it&amp;rsquo;s the kind of thing that&amp;rsquo;s going to be useful to trot out when people ask, and the write up should contribute to one of my highest priority items, which is a plan for the AgileVentures charity to regularly pay for my family and I to eat.&lt;/p&gt;
</content>
  </entry>
</feed>
